name: Build Skin-Check Ecosystem

on:
  push:
    branches: ["main"]
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build-ecosystem:
    runs-on: ubuntu-latest

    steps:
      - name: Code auschecken
        uses: actions/checkout@v3

      - name: Python einrichten
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # SCHRITT 1: Datenbank (Die Basis)
      - name: 1. Datenbank generieren ğŸ§ª
        run: python generate_inci.py
      
      # SCHRITT 2: Lexikon (Die SEO Seiten)
      - name: 2. Lexikon generieren ğŸ“š
        run: python build_skin_lexikon.py

      # SCHRITT 3: Blog (Die Artikel) ğŸ†•
      - name: 3. Blog generieren âœï¸
        run: python build_skin_blog.py

      # SCHRITT 4: App (Der Scanner)
      - name: 4. App bauen ğŸ’…
        run: python build_skin_app.py
        
      # SCHRITT 5: Speichern
      - name: Alles speichern & verÃ¶ffentlichen ğŸš€
        run: |
          git config --global user.name "Skin-Bot ğŸ¤–"
          git config --global user.email "bot@skincheck.app"
          
          # Alles hinzufÃ¼gen (auch den neuen 'blog' Ordner)
          git add .
          
          # Commit & Push nur bei Ã„nderungen
          git diff-index --quiet HEAD || (git commit -m "ğŸš€ Ecosystem Update: Blog Live" && git push)
