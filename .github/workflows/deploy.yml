name: Build Skin-Check Ecosystem

on:
  push:
    branches: ["main"]
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build-ecosystem:
    runs-on: ubuntu-latest

    steps:
      - name: Code auschecken
        uses: actions/checkout@v3

      - name: Python einrichten
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # SCHRITT 1: Datenbank (Das Wissen)
      - name: 1. Datenbank generieren ðŸ§ª
        run: python generate_inci.py
      
      # SCHRITT 2: Lexikon (Die SEO Seiten)
      - name: 2. Lexikon generieren ðŸ“š
        run: python build_skin_lexikon.py

      # SCHRITT 3: App (Der Scanner)
      - name: 3. App bauen ðŸ’…
        run: python build_skin_app.py
        
      # SCHRITT 4: Speichern
      - name: Alles speichern & verÃ¶ffentlichen ðŸš€
        run: |
          git config --global user.name "Skin-Bot ðŸ¤–"
          git config --global user.email "bot@skincheck.app"
          
          # Wir fÃ¼gen alles hinzu (auch den neuen 'lexikon' Ordner)
          git add .
          
          # Commit & Push nur bei Ã„nderungen
          git diff-index --quiet HEAD || (git commit -m "ðŸš€ Ecosystem Update: App + Lexikon Live" && git push)
